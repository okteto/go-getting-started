build:
  hello-world:
    image: okteto.dev/go-hello-world:1.0.0
    context: .

deploy:
  - name: deploy env
    command: kubectl apply -f k8s.yml
  - name: Set randomly password
    command: echo "OKTETO_RANDOM_PASS=P@sSvV0rD" >> $OKTETO_ENV
  - name: Set another randomly password
    command: echo "OKTETO_RANDOM2_PASS=P@sSvV0rD333" >> $OKTETO_ENV

dev:
  hello-world:
    image: okteto/golang:1
    command: bash
    sync:
      - .:/usr/src/app
    volumes:
      - /go
      - /root/.cache
    securityContext:
      capabilities:
        add:
          - SYS_PTRACE
    forward:
      - 2345:2345

external:
  db:
    notes: docs/database.md
    icon: database
    endpoints:
    - name: db
      url: https://localhost:3306